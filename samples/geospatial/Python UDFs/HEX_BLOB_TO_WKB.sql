CREATE OR REPLACE FUNCTION HEX_BLOB_TO_WKB (raw_hex STRING)
RETURNS BINARY
LANGUAGE SQL
STRICT
AS
$$
SELECT
  CASE
      WHEN pos = 0 THEN NULL
      ELSE TO_BINARY('01' || SUBSTR(hx, pos + 2), 'HEX')
  END
FROM (
  SELECT
      IFF(
          RIGHT(LOWER(TRIM(raw_hex)), 2) = 'fe',
          LEFT(LOWER(TRIM(raw_hex)), LEN(TRIM(raw_hex)) - 2),
          LOWER(TRIM(raw_hex))
      ) AS hx,
      REGEXP_INSTR(
            IFF(
                RIGHT(LOWER(TRIM(raw_hex)), 2) = 'fe',
                LEFT(LOWER(TRIM(raw_hex)), LEN(TRIM(raw_hex)) - 2),
                LOWER(TRIM(raw_hex))
            ),
            '7c0[1235]000000'
      ) AS pos
) s
$$;



with raw as (SELECT HEX_BLOB_TO_WKB('0001346c0000d9cef713eb3a2341333333330fbf0c4133333333213b2341fca9f1d2adbf0c417c030000000300000019000000000000801e3b23410000000060bf0c41666666e61d3b23410000000072bf0c415a643b5f1c3b2341b6f3fdd472bf0c411283c0ca183b2341560e2db273bf0c41a69bc460153b23419eefa7c676bf0c417f6abc74113b2341df4f8d977abf0c418716d9ce0e3b2341c520b0727ebf0c419eefa7c60c3b2341b81e85eb82bf0c418fc2f5a8093b2341b4c876be87bf0c412b871659063b234179e926318fbf0c416de7fb29033b234179e9263195bf0c41c976bedfff3a2341c520b0729abf0c413108ac5cfc3a2341ba490c029fbf0c413d0ad7e3f83a2341a01a2fdda2bf0c4162105879ee3a2341022b8716adbf0c411d5a64fbec3a2341fca9f1d2adbf0c4123dbf9feeb3a2341355eba495fbf0c41f6285c4feb3a2341e7fba9f126bf0c41d9cef713eb3a2341a01a2fdd13bf0c4148e17a14f03a23410ad7a37013bf0c4152b81e85003b23410000000012bf0c41f6285c0f113b2341f6285c8f10bf0c4133333333213b2341333333330fbf0c4148e17a94203b23410000000022bf0c41000000801e3b23410000000060bf0c410500000060e5d022f93a2341986e128321bf0c41b29def67f93a23416de7fba953bf0c41c74b37c9073b234196438b6c52bf0c4175931884073b23417b14ae4720bf0c4160e5d022f93a2341986e128321bf0c4105000000fed478e90c3b23415eba490c28bf0c41f2d24d220d3b23411f85eb5151bf0c4104560eed163b2341f4fdd47850bf0c41105839b4163b2341ee7c3f3527bf0c41fed478e90c3b23415eba490c28bf0c41fe') as s)
select to_geometry(s)
from raw;