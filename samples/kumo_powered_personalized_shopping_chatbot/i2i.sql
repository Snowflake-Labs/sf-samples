CREATE OR REPLACE CORTEX SEARCH SERVICE KUMO_CHATBOT_NAISHA.PUBLIC.item_to_item_service
ON search_text
ATTRIBUTES ENTITY_TYPE, ITEM_ID
WAREHOUSE = WAREHOUSE_SMALL
TARGET_LAG = '1 hour'
AS
    -- Search predictions from ITEM_TO_ITEM_PREDICTIONS_ENRICHED
    SELECT
        'PREDICTIONS' AS ENTITY_TYPE,
        ITEM_ID,
        FORMATTED_PREDICTIONS AS search_text
    FROM
        KUMO_CHATBOT_NAISHA.PUBLIC.ITEM_TO_ITEM_PREDICTIONS_LESS

    UNION ALL

    -- Search item information from ITEM_INFO table
    SELECT
        'ITEM_INFO' AS ENTITY_TYPE,
        ITEM_ID,
        ITEM_INFO AS search_text
    FROM
        KUMO_CHATBOT_NAISHA.PUBLIC.ITEM_INFO;